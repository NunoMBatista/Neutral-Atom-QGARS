<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="919px" preserveAspectRatio="none" style="width:989px;height:919px;" version="1.1" viewBox="0 0 989 919" width="989px" zoomAndPan="magnify"><defs><filter height="300%" id="f1mv2500uimlgh" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[fb14c9b1fd95d0c04eeb1a4af9d96e82]
entity input--><rect fill="#F8F8F8" filter="url(#f1mv2500uimlgh)" height="36.3441" style="stroke: #383838; stroke-width: 1.5;" width="91" x="6" y="8"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="1" y="13"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="1" y="34.3441"/><text fill="#000000" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="71" x="16" y="30.8281">INPUT DATA</text><!--MD5=[95aea0a53efb618fc569ece1197781df]
entity encoder--><rect fill="#F8F8F8" filter="url(#f1mv2500uimlgh)" height="36.3441" style="stroke: #383838; stroke-width: 1.5;" width="168" x="132.5" y="8"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="127.5" y="13"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="127.5" y="34.3441"/><text fill="#000000" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="148" x="142.5" y="30.8281">AUTOENCODER ENCODER</text><!--MD5=[8c2793f18c0d2d4e65a4ad8131d5f8b3]
entity encoding--><rect fill="#F8F8F8" filter="url(#f1mv2500uimlgh)" height="36.3441" style="stroke: #383838; stroke-width: 1.5;" width="84" x="335.5" y="8"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="330.5" y="13"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="330.5" y="34.3441"/><text fill="#000000" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="64" x="345.5" y="30.8281">ENCODING</text><!--MD5=[1a1f727908a501275905650efe539c95]
entity decoder--><rect fill="#F8F8F8" filter="url(#f1mv2500uimlgh)" height="36.3441" style="stroke: #383838; stroke-width: 1.5;" width="168" x="469.5" y="8"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="464.5" y="13"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="464.5" y="34.3441"/><text fill="#000000" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="148" x="479.5" y="30.8281">AUTOENCODER DECODER</text><!--MD5=[376f913b00f03efb2847558375e0e391]
entity reconstruction--><rect fill="#F8F8F8" filter="url(#f1mv2500uimlgh)" height="36.3441" style="stroke: #383838; stroke-width: 1.5;" width="127" x="681" y="8"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="676" y="13"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="676" y="34.3441"/><text fill="#000000" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="107" x="691" y="30.8281">RECONSTRUCTION</text><!--MD5=[7005c0a3acff0385f3cd8fbf577c28a2]
entity quantum--><rect fill="#F8F8F8" filter="url(#f1mv2500uimlgh)" height="36.3441" style="stroke: #383838; stroke-width: 1.5;" width="120" x="317.5" y="104"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="312.5" y="109"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="312.5" y="130.3441"/><text fill="#000000" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="100" x="327.5" y="126.8281">QUANTUM LAYER</text><!--MD5=[4cc89b328987dc7afef05a3b51de1e72]
entity q_embeddings--><rect fill="#F8F8F8" filter="url(#f1mv2500uimlgh)" height="36.3441" style="stroke: #383838; stroke-width: 1.5;" width="165" x="307" y="200"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="302" y="205"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="302" y="226.3441"/><text fill="#000000" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="145" x="317" y="222.8281">QUANTUM EMBEDDINGS</text><!--MD5=[23ec4f1fff159d71b633b9f85a9aab58]
entity cache--><rect fill="#F8F8F8" filter="url(#f1mv2500uimlgh)" height="36.3441" style="stroke: #383838; stroke-width: 1.5;" width="60" x="507.5" y="200"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="502.5" y="205"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="502.5" y="226.3441"/><text fill="#000000" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="40" x="517.5" y="222.8281">CACHE</text><!--MD5=[5130ab9d18b342ea3dd4d1635cca6a1e]
entity surr_training--><rect fill="#F8F8F8" filter="url(#f1mv2500uimlgh)" height="36.3441" style="stroke: #383838; stroke-width: 1.5;" width="150" x="314.5" y="296"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="309.5" y="301"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="309.5" y="322.3441"/><text fill="#000000" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="130" x="324.5" y="318.8281">SURROGATE TRAINING</text><!--MD5=[09e344fe5cb8186a6516d913a656c1fc]
entity surrogate--><rect fill="#F8F8F8" filter="url(#f1mv2500uimlgh)" height="36.3441" style="stroke: #383838; stroke-width: 1.5;" width="135" x="298" y="392"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="293" y="397"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="293" y="418.3441"/><text fill="#000000" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="115" x="308" y="414.8281">SURROGATE MODEL</text><!--MD5=[a36f45ece4fb426aa6104597efa1a909]
entity sim_embeddings--><rect fill="#F8F8F8" filter="url(#f1mv2500uimlgh)" height="36.3441" style="stroke: #383838; stroke-width: 1.5;" width="236" x="306.5" y="488"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="301.5" y="493"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="301.5" y="514.3441"/><text fill="#000000" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="216" x="316.5" y="510.8281">SIMULATED QUANTUM EMBEDDINGS</text><!--MD5=[8465953bbe20660cbebb560a1225899c]
entity classifier--><rect fill="#F8F8F8" filter="url(#f1mv2500uimlgh)" height="36.3441" style="stroke: #383838; stroke-width: 1.5;" width="84" x="453.5" y="584"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="448.5" y="589"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="448.5" y="610.3441"/><text fill="#000000" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="64" x="463.5" y="606.8281">CLASSIFIER</text><!--MD5=[83a8157c84c7fbb70c5b579330f814f1]
entity predictions--><rect fill="#F8F8F8" filter="url(#f1mv2500uimlgh)" height="36.3441" style="stroke: #383838; stroke-width: 1.5;" width="137" x="451" y="680"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="446" y="685"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="446" y="706.3441"/><text fill="#000000" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="117" x="461" y="702.8281">CLASS PREDICTIONS</text><!--MD5=[b1feb2883bef34d3d3b2ae36fdfae2ae]
entity rec_loss--><rect fill="#F8F8F8" filter="url(#f1mv2500uimlgh)" height="36.3441" style="stroke: #383838; stroke-width: 1.5;" width="159" x="673" y="104"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="668" y="109"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="668" y="130.3441"/><text fill="#000000" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="139" x="683" y="126.8281">RECONSTRUCTION LOSS</text><!--MD5=[965b24b8d781dea58017d4761174b908]
entity class_loss--><rect fill="#F8F8F8" filter="url(#f1mv2500uimlgh)" height="36.3441" style="stroke: #383838; stroke-width: 1.5;" width="147" x="507" y="776"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="502" y="781"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="502" y="802.3441"/><text fill="#000000" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="127" x="517" y="798.8281">CLASSIFICATION LOSS</text><!--MD5=[f64381fd01bac541e60eaa71b1a24d28]
entity labels--><rect fill="#F8F8F8" filter="url(#f1mv2500uimlgh)" height="36.3441" style="stroke: #383838; stroke-width: 1.5;" width="95" x="533" y="872"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="528" y="877"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="528" y="898.3441"/><text fill="#000000" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="75" x="543" y="894.8281">TRUE LABELS</text><!--MD5=[6ce5d8c1ea04b032a66993a59f904699]
entity total_loss--><rect fill="#F8F8F8" filter="url(#f1mv2500uimlgh)" height="36.3441" style="stroke: #383838; stroke-width: 1.5;" width="89" x="708" y="200"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="703" y="205"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="703" y="226.3441"/><text fill="#000000" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="69" x="718" y="222.8281">TOTAL LOSS</text><!--MD5=[b1f7be14a6a6fc2301deaeabea73a20d]
entity backprop--><rect fill="#F8F8F8" filter="url(#f1mv2500uimlgh)" height="36.3441" style="stroke: #383838; stroke-width: 1.5;" width="135" x="709" y="296"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="704" y="301"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="704" y="322.3441"/><text fill="#000000" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="115" x="719" y="318.8281">BACKPROPAGATION</text><!--MD5=[e234cd3cb5308f7cac8826dfefd9b44b]
entity updates--><rect fill="#F8F8F8" filter="url(#f1mv2500uimlgh)" height="36.3441" style="stroke: #383838; stroke-width: 1.5;" width="146" x="706.5" y="392"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="701.5" y="397"/><rect fill="#F8F8F8" height="5" style="stroke: #383838; stroke-width: 1.5;" width="10" x="701.5" y="418.3441"/><text fill="#000000" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="126" x="716.5" y="414.8281">PARAMETER UPDATES</text><path d="M468.5,397 L468.5,406 L433.17,410 L468.5,414 L468.5,423.3441 A0,0 0 0 0 468.5,423.3441 L600.5,423.3441 A0,0 0 0 0 600.5,423.3441 L600.5,407 L590.5,397 L468.5,397 A0,0 0 0 0 468.5,397 " fill="#ECECEC" filter="url(#f1mv2500uimlgh)" style="stroke: #383838; stroke-width: 1.0;"/><path d="M590.5,397 L590.5,407 L600.5,407 L590.5,397 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="111" x="474.5" y="414.8281">Differentiable proxy</text><path d="M473,109 L473,118 L437.64,122 L473,126 L473,135.3441 A0,0 0 0 0 473,135.3441 L638,135.3441 A0,0 0 0 0 638,135.3441 L638,119 L628,109 L473,109 A0,0 0 0 0 473,109 " fill="#ECECEC" filter="url(#f1mv2500uimlgh)" style="stroke: #383838; stroke-width: 1.0;"/><path d="M628,109 L628,119 L638,119 L628,109 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="144" x="479" y="126.8281">Non-differentiable barrier</text><path d="M832,205 L832,214 L797.03,218 L832,222 L832,231.3441 A0,0 0 0 0 832,231.3441 L977,231.3441 A0,0 0 0 0 977,231.3441 L977,215 L967,205 L832,205 A0,0 0 0 0 832,205 " fill="#ECECEC" filter="url(#f1mv2500uimlgh)" style="stroke: #383838; stroke-width: 1.0;"/><path d="M967,205 L967,215 L977,215 L967,205 " fill="#ECECEC" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="Arial" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="124" x="838" y="222.8281">(1-位)*Recon + 位*Class</text><!--MD5=[709f9a16be2b8c4a14548c29e1db594a]
link input to encoder--><path d="M97.26,26 C107.18,26 117.09,26 127.01,26 " fill="none" id="input-&gt;encoder" style="stroke: #000000; stroke-width: 2.0;"/><polygon fill="#000000" points="132.19,26,123.19,22,127.19,26,123.19,30,132.19,26" style="stroke: #000000; stroke-width: 2.0;"/><path d="M99.26,28 C109.18,28 119.09,28 129.01,28 " fill="none" id="input-&gt;encoder" style="stroke: #FFFFFF; stroke-width: 2.0;"/><!--MD5=[ea65f5547b2b89101be2551de9c7f500]
link encoder to encoding--><path d="M300.77,26 C310.56,26 320.34,26 330.12,26 " fill="none" id="encoder-&gt;encoding" style="stroke: #000000; stroke-width: 2.0;"/><polygon fill="#000000" points="335.24,26,326.24,22,330.24,26,326.24,30,335.24,26" style="stroke: #000000; stroke-width: 2.0;"/><path d="M302.77,28 C312.56,28 322.34,28 332.12,28 " fill="none" id="encoder-&gt;encoding" style="stroke: #FFFFFF; stroke-width: 2.0;"/><!--MD5=[cb30c2885a4bd64c9b73e81a576d616c]
link encoding to quantum--><path d="M377.5,44.24 C377.5,59.48 377.5,81.81 377.5,98.46 " fill="none" id="encoding-&gt;quantum" style="stroke: #000000; stroke-width: 2.0;"/><polygon fill="#000000" points="377.5,103.87,381.5,94.87,377.5,98.87,373.5,94.87,377.5,103.87" style="stroke: #000000; stroke-width: 2.0;"/><path d="M379.5,46.24 C379.5,61.48 379.5,83.81 379.5,100.46 " fill="none" id="encoding-&gt;quantum" style="stroke: #FFFFFF; stroke-width: 2.0;"/><!--MD5=[15b1f1e6c4fcf413abe49cbf0a30fa95]
link encoding to decoder--><path d="M419.78,26 C434.64,26 449.5,26 464.36,26 " fill="none" id="encoding-&gt;decoder" style="stroke: #000000; stroke-width: 2.0;"/><polygon fill="#000000" points="469.4,26,460.4,22,464.4,26,460.4,30,469.4,26" style="stroke: #000000; stroke-width: 2.0;"/><path d="M421.78,28 C436.64,28 451.5,28 466.36,28 " fill="none" id="encoding-&gt;decoder" style="stroke: #FFFFFF; stroke-width: 2.0;"/><!--MD5=[63f863e2a4d46431157470f300675bc6]
link decoder to reconstruction--><path d="M637.81,26 C650.44,26 663.07,26 675.7,26 " fill="none" id="decoder-&gt;reconstruction" style="stroke: #000000; stroke-width: 2.0;"/><polygon fill="#000000" points="680.74,26,671.74,22,675.74,26,671.74,30,680.74,26" style="stroke: #000000; stroke-width: 2.0;"/><path d="M639.81,28 C652.44,28 665.07,28 677.7,28 " fill="none" id="decoder-&gt;reconstruction" style="stroke: #FFFFFF; stroke-width: 2.0;"/><!--MD5=[e8ca6dc70821d91916e84604b7cfb374]
link reconstruction to rec_loss--><path d="M745.97,44.24 C747.26,59.48 749.16,81.81 750.58,98.46 " fill="none" id="reconstruction-&gt;rec_loss" style="stroke: #000000; stroke-width: 2.0;"/><polygon fill="#000000" points="751.04,103.87,754.281,94.5697,750.626,98.8872,746.3085,95.2321,751.04,103.87" style="stroke: #000000; stroke-width: 2.0;"/><path d="M747.97,46.24 C749.26,61.48 751.16,83.81 752.58,100.46 " fill="none" id="reconstruction-&gt;rec_loss" style="stroke: #FFFFFF; stroke-width: 2.0;"/><!--MD5=[ccd9cd6d60916d775eba328ea90629b7]
link quantum to q_embeddings--><path d="M379.7,140.24 C381.66,155.61 384.55,178.2 386.68,194.89 " fill="none" id="quantum-&gt;q_embeddings" style="stroke: #000000; stroke-width: 2.0;"/><polygon fill="#000000" points="387.31,199.87,390.1495,190.4393,386.6828,194.9095,382.2127,191.4428,387.31,199.87" style="stroke: #000000; stroke-width: 2.0;"/><path d="M381.7,142.24 C383.66,157.61 386.55,180.2 388.68,196.89 " fill="none" id="quantum-&gt;q_embeddings" style="stroke: #FFFFFF; stroke-width: 2.0;"/><!--MD5=[0cd03f2ecf9cb3c17130420a5c8f2d91]
link q_embeddings to cache--><path d="M472.17,218 C482.17,218 492.16,218 502.16,218 " fill="none" id="q_embeddings-&gt;cache" style="stroke: #000000; stroke-width: 2.0;"/><polygon fill="#000000" points="507.39,218,498.39,214,502.39,218,498.39,222,507.39,218" style="stroke: #000000; stroke-width: 2.0;"/><path d="M474.17,220 C484.17,220 494.16,220 504.16,220 " fill="none" id="q_embeddings-&gt;cache" style="stroke: #FFFFFF; stroke-width: 2.0;"/><!--MD5=[d0295b559f08c019c843c4a39ea02740]
link q_embeddings to surr_training--><path d="M389.5,236.24 C389.5,251.48 389.5,273.81 389.5,290.46 " fill="none" id="q_embeddings-&gt;surr_training" style="stroke: #000000; stroke-width: 2.0;"/><polygon fill="#000000" points="389.5,295.87,393.5,286.87,389.5,290.87,385.5,286.87,389.5,295.87" style="stroke: #000000; stroke-width: 2.0;"/><path d="M391.5,238.24 C391.5,253.48 391.5,275.81 391.5,292.46 " fill="none" id="q_embeddings-&gt;surr_training" style="stroke: #FFFFFF; stroke-width: 2.0;"/><!--MD5=[45d9b6ff039af7d9a2ef608c357dd77f]
link cache to surr_training--><path d="M510.7,236.02 C485.5,252.03 447.77,275.99 421.11,292.92 " fill="none" id="cache-&gt;surr_training" style="stroke: #000000; stroke-width: 2.0;"/><polygon fill="#000000" points="416.6,295.79,426.3395,294.3264,420.8165,293.1028,422.0401,287.5799,416.6,295.79" style="stroke: #000000; stroke-width: 2.0;"/><path d="M512.7,238.02 C487.5,254.03 449.77,277.99 423.11,294.92 " fill="none" id="cache-&gt;surr_training" style="stroke: #FFFFFF; stroke-width: 2.0;"/><!--MD5=[32a85a1f876c2c8c9f62e35a31fa5cdd]
link surr_training to surrogate--><path d="M385.1,332.24 C381.17,347.61 375.41,370.2 371.14,386.89 " fill="none" id="surr_training-&gt;surrogate" style="stroke: #000000; stroke-width: 2.0;"/><polygon fill="#000000" points="369.87,391.87,375.9817,384.1468,371.1129,387.0269,368.2328,382.1582,369.87,391.87" style="stroke: #000000; stroke-width: 2.0;"/><path d="M387.1,334.24 C383.17,349.61 377.41,372.2 373.14,388.89 " fill="none" id="surr_training-&gt;surrogate" style="stroke: #FFFFFF; stroke-width: 2.0;"/><!--MD5=[7578da08dfc37d41407710cd60ecfa83]
link encoding to surrogate--><path d="M352.59,44.14 C334.56,58.03 311.36,79.3 299.5,104 C280.93,142.67 291.73,157.16 289.5,200 C286.45,258.67 273.53,277.93 296.5,332 C305.95,354.24 324.53,374.38 340.04,388.48 " fill="none" id="encoding-&gt;surrogate" style="stroke: #000000; stroke-width: 2.0;"/><polygon fill="#000000" points="343.91,391.93,339.8599,382.9524,340.1801,388.6002,334.5323,388.9203,343.91,391.93" style="stroke: #000000; stroke-width: 2.0;"/><path d="M354.59,46.14 C336.56,60.03 313.36,81.3 301.5,106 C282.93,144.67 293.73,159.16 291.5,202 C288.45,260.67 275.53,279.93 298.5,334 C307.95,356.24 326.53,376.38 342.04,390.48 " fill="none" id="encoding-&gt;surrogate" style="stroke: #FFFFFF; stroke-width: 2.0;"/><!--MD5=[a87adfd39643baf842edf8c5d693e52b]
link surrogate to sim_embeddings--><path d="M376.32,428.24 C386.05,443.74 400.39,466.59 410.89,483.32 " fill="none" id="surrogate-&gt;sim_embeddings" style="stroke: #000000; stroke-width: 2.0;"/><polygon fill="#000000" points="413.75,487.87,412.3484,478.1214,411.0897,483.6364,405.5747,482.3778,413.75,487.87" style="stroke: #000000; stroke-width: 2.0;"/><path d="M378.32,430.24 C388.05,445.74 402.39,468.59 412.89,485.32 " fill="none" id="surrogate-&gt;sim_embeddings" style="stroke: #FFFFFF; stroke-width: 2.0;"/><!--MD5=[daea1092084b259e393b4545af3122b9]
link sim_embeddings to classifier--><path d="M437.52,524.24 C449.33,539.88 466.78,562.98 479.45,579.75 " fill="none" id="sim_embeddings-&gt;classifier" style="stroke: #000000; stroke-width: 2.0;"/><polygon fill="#000000" points="482.56,583.87,480.3216,574.2789,479.544,579.882,473.9409,579.1045,482.56,583.87" style="stroke: #000000; stroke-width: 2.0;"/><path d="M439.52,526.24 C451.33,541.88 468.78,564.98 481.45,581.75 " fill="none" id="sim_embeddings-&gt;classifier" style="stroke: #FFFFFF; stroke-width: 2.0;"/><!--MD5=[e17fbd339c07b8377f7a53c0bd849bca]
link classifier to predictions--><path d="M499.9,620.24 C503.83,635.61 509.59,658.2 513.86,674.89 " fill="none" id="classifier-&gt;predictions" style="stroke: #000000; stroke-width: 2.0;"/><polygon fill="#000000" points="515.13,679.87,516.7672,670.1582,513.8871,675.0269,509.0183,672.1468,515.13,679.87" style="stroke: #000000; stroke-width: 2.0;"/><path d="M501.9,622.24 C505.83,637.61 511.59,660.2 515.86,676.89 " fill="none" id="classifier-&gt;predictions" style="stroke: #FFFFFF; stroke-width: 2.0;"/><!--MD5=[e153adbea45c143f57d38bcb4757317a]
link predictions to class_loss--><path d="M530.69,716.24 C540.75,731.74 555.57,754.59 566.43,771.32 " fill="none" id="predictions-&gt;class_loss" style="stroke: #000000; stroke-width: 2.0;"/><polygon fill="#000000" points="569.38,775.87,567.8312,766.1437,566.6561,771.6771,561.1226,770.502,569.38,775.87" style="stroke: #000000; stroke-width: 2.0;"/><path d="M532.69,718.24 C542.75,733.74 557.57,756.59 568.43,773.32 " fill="none" id="predictions-&gt;class_loss" style="stroke: #FFFFFF; stroke-width: 2.0;"/><!--MD5=[5d439e95a7116b1b677c718d9a21058f]
reverse link class_loss to labels--><path d="M580.5,817.66 C580.5,834.34 580.5,856.66 580.5,871.87 " fill="none" id="class_loss&lt;-labels" style="stroke: #000000; stroke-width: 2.0;"/><polygon fill="#000000" points="580.5,812.24,576.5,821.24,580.5,817.24,584.5,821.24,580.5,812.24" style="stroke: #000000; stroke-width: 2.0;"/><path d="M582.5,819.66 C582.5,836.34 582.5,858.66 582.5,873.87 " fill="none" id="class_loss&lt;-labels" style="stroke: #FFFFFF; stroke-width: 2.0;"/><!--MD5=[ac62859aeee8d6c60b7933d9855b7efb]
link rec_loss to total_loss--><path d="M752.5,140.24 C752.5,155.48 752.5,177.81 752.5,194.46 " fill="none" id="rec_loss-&gt;total_loss" style="stroke: #000000; stroke-width: 2.0;"/><polygon fill="#000000" points="752.5,199.87,756.5,190.87,752.5,194.87,748.5,190.87,752.5,199.87" style="stroke: #000000; stroke-width: 2.0;"/><path d="M754.5,142.24 C754.5,157.48 754.5,179.81 754.5,196.46 " fill="none" id="rec_loss-&gt;total_loss" style="stroke: #FFFFFF; stroke-width: 2.0;"/><!--MD5=[96d28826e33a24e70bc5e2875317ca0a]
reverse link total_loss to class_loss--><path d="M732.74,240.16 C703.86,273.4 653.5,341.09 653.5,409 C653.5,409 653.5,409 653.5,603 C653.5,670.67 612.65,743.42 592.07,775.78 " fill="none" id="total_loss&lt;-class_loss" style="stroke: #000000; stroke-width: 2.0;"/><polygon fill="#000000" points="736.15,236.28,727.2054,240.4024,732.8504,240.0367,733.2161,245.6817,736.15,236.28" style="stroke: #000000; stroke-width: 2.0;"/><path d="M734.74,242.16 C705.86,275.4 655.5,343.09 655.5,411 C655.5,411 655.5,411 655.5,605 C655.5,672.67 614.65,745.42 594.07,777.78 " fill="none" id="total_loss&lt;-class_loss" style="stroke: #FFFFFF; stroke-width: 2.0;"/><!--MD5=[787a995b99c4b14f61e1bd3c67c1e6c0]
link total_loss to backprop--><path d="M756.9,236.24 C760.83,251.61 766.59,274.2 770.86,290.89 " fill="none" id="total_loss-&gt;backprop" style="stroke: #000000; stroke-width: 2.0;"/><polygon fill="#000000" points="772.13,295.87,773.7672,286.1582,770.8871,291.0269,766.0183,288.1468,772.13,295.87" style="stroke: #000000; stroke-width: 2.0;"/><path d="M758.9,238.24 C762.83,253.61 768.59,276.2 772.86,292.89 " fill="none" id="total_loss-&gt;backprop" style="stroke: #FFFFFF; stroke-width: 2.0;"/><!--MD5=[2a613208a34f12a2e752e5c1bcc6276a]
link backprop to updates--><path d="M777.05,332.24 C777.54,347.48 778.25,369.81 778.78,386.46 " fill="none" id="backprop-&gt;updates" style="stroke: #000000; stroke-width: 2.0;"/><polygon fill="#000000" points="778.95,391.87,782.6393,382.7382,778.7787,386.8729,774.644,383.0123,778.95,391.87" style="stroke: #000000; stroke-width: 2.0;"/><path d="M779.05,334.24 C779.54,349.48 780.25,371.81 780.78,388.46 " fill="none" id="backprop-&gt;updates" style="stroke: #FFFFFF; stroke-width: 2.0;"/><!--MD5=[341045ac14a8c30c79676b965be8a9df]
@startuml
skinparam monochrome true
skinparam componentStyle rectangle
skinparam defaultFontName Arial
skinparam defaultFontSize 12
skinparam ArrowThickness 2

component "INPUT DATA" as input
component "AUTOENCODER ENCODER" as encoder
component "ENCODING" as encoding
component "AUTOENCODER DECODER" as decoder
component "RECONSTRUCTION" as reconstruction
component "QUANTUM LAYER" as quantum
component "QUANTUM EMBEDDINGS" as q_embeddings
component "CACHE" as cache
component "SURROGATE TRAINING" as surr_training
component "SURROGATE MODEL" as surrogate
component "SIMULATED QUANTUM EMBEDDINGS" as sim_embeddings
component "CLASSIFIER" as classifier
component "CLASS PREDICTIONS" as predictions
component "RECONSTRUCTION LOSS" as rec_loss
component "CLASSIFICATION LOSS" as class_loss
component "TRUE LABELS" as labels
component "TOTAL LOSS" as total_loss
component "BACKPROPAGATION" as backprop
component "PARAMETER UPDATES" as updates

input -[#black;#white]right-> encoder
encoder -[#black;#white]right-> encoding
encoding -[#black;#white]down-> quantum
encoding -[#black;#white]right-> decoder
decoder -[#black;#white]right-> reconstruction
reconstruction -[#black;#white]down-> rec_loss
quantum -[#black;#white]down-> q_embeddings
q_embeddings -[#black;#white]right-> cache
q_embeddings -[#black;#white]down-> surr_training
cache -[#black;#white]down-> surr_training
surr_training -[#black;#white]down-> surrogate
encoding -[#black;#white]down-> surrogate
surrogate -[#black;#white]down-> sim_embeddings
sim_embeddings -[#black;#white]down-> classifier
classifier -[#black;#white]down-> predictions
predictions -[#black;#white]down-> class_loss
labels -[#black;#white]up-> class_loss
rec_loss -[#black;#white]down-> total_loss
class_loss -[#black;#white]left-> total_loss
total_loss -[#black;#white]down-> backprop
backprop -[#black;#white]down-> updates

note right of surrogate: Differentiable proxy
note right of quantum: Non-differentiable barrier
note right of total_loss: (1-位)*Recon + 位*Class

@enduml

PlantUML version 1.2020.02(Sun Mar 01 10:22:07 WET 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 17.0.14+7-Debian-1deb12u1
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>